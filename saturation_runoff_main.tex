\documentclass[a4paper,11pt,twocolumn]{article}
\usepackage{lingmacros}
\usepackage{blindtext}
\usepackage{tree-dvips}
\usepackage{amsmath}
\usepackage{multicol}
\usepackage{mathtools}
\usepackage{hyperref}
\usepackage{graphicx}
\usepackage{amssymb}
\usepackage[table]{xcolor}
\usepackage{textcomp}
\graphicspath{ {./Latex/} }
%\usepackage{wrapfig}

\begin{document}

\title{Surface and subsurface runoff in relation to saturation and ground cover}
\date{2020\\ April}
\author{Eirik Nordgård\\ Geophysical Institute,\ University of Oslo}


\twocolumn[
\begin{@twocolumnfalse}
\maketitle
\begin{abstract}
An abstract containing main aim and findings of the paper.
\end{abstract}

All material for this project may be found on 
\url{https://github.com/eirikngard/GEO4322---Surface-Energy-Balance-in-Cold-Environments}

\end{@twocolumnfalse}
]
\
\section{Introduction}

The main scope of the paper is to investigate how soil water saturation affects the surface and subsurface runoff in a simple bucket model with varying soil depth. \textit{Bucket depth} is analogous to \textit{soil depth}, meaning that a bucket with water represents soil on top of bedrock on a confined area. Like in nature, pouring water into the bucket beyond its capacity will cause surface runoff. This feature is modelled in its simplest way by defining the saturation of the bucket to be water level divided by bucket depth. Hence, a deeper bucket should experience less surface runoff compared to a shallow bucket. Subsurface flow is also modelled with a linear relationship to the saturation. The surface energy balance is of great importance to the bucket model since it dictates the water balance by defining whether the ground is frozen or not. In reality, surface runoff may occur even if the ground is frozen, but for simplicity the model allows no surface runoff once the ground temperature is below zero. 

\
The paper is structured as follows. Theory in section 2. Section 3 is method. Section 4 is results and section 5 is discussion. Last, section 6 is future work. 
\
\section{Theory}


\subsection{Surface Energy Balance}
Here you should explain i detail how to energy balance in the model is done. All parts of the code should be explained her. Then, explain why the resulting energies and hence temperatures is important for the water balance. Within this paragraph, explain how the model deals with saturation and how its defined. 

The surface energy balance is calculated for daily timesteps. Initallly, the following forcing termes are givven through point  measurements: Air temperature $T_{air}$, precipitation, incoming shortwave $S_{in} $and longwave radiation $L_{in}$, windspeed and specific humidity.
Shortwave refelced radiation is calculated using the albedo, $\alpha$, in the following formula;
\begin{equation}
	S_{out} = \alpha * S_{in}
\end{equation}

The albedo used in this model is set to 0.2. Stefan-Boltzmann law is then \textbf{source} used to calculate the longwave outgoing radiation;

\begin{equation}
	L_{out} = \sigma * (T_{surf}+273.15)^4
\end{equation}
where $\sigma$ is the Stefan-Boltzmann constant equal to $5.670*10^8 \; Wm^{-2}K^{-4}$ and $T_{surf}$ is the surface temperature. 

Essential to the surface energy balance is also the conductive ground heat flux between the surface with depth $d_{surf}$, and the layer below below with depth $d_{ground}$. Ideally it is a heat flux between an infinite number of layers, but for simplification only one layer is used in addition to the surface layer. The conductive flux between the first and the second layer is calculated using Fourier's law of heat conduction;
\begin{equation}
\begin{multlined}
F_{cond} = //
-K*(T_{surf}-T_{ground})/((d_{surf}+d_{ground})/2)
\end{multlined}
\end{equation}
	
where $K = 3 Wm^{-1}k^{-1}$ is the thermal conductivity of rock \textbf{source}. 

Sensible heat flux is calculated through
%    Q_h = (-rho*cp*kappa*5*kappa/math.log(z/z0))*((Tair-T1)/%math.log(z/z0));
this formula. 

Latent heat flux is calculated through 
%Q_e_pot = -rho_air*L_w*kappa*windspeed*kappa/math.log(z/z0)*(q-satPresWater/p)/math.log(z/z0);

%Q_e = saturation*Q_e_pot;

%water_out_evapotranspiration = Q_e/(L_w*rho_water);

Now the energy balance is done for the surface layer  
\begin{equation}
	E_{surf} = E + S_{in}-S_{out}+L_{in}-L_{out}+F_{cond}-F_{sens}-F_{lat}
	\label{eq:surfenergy}
\end{equation}
and the layer below
\begin{equation}
E_{ground} = E-F_{cond}
	\label{eq:groundenergy}
\end{equation}
In Eq. (\ref{eq:surfenergy}) and Eq. (\ref{eq:groundenergy}) $E$ is the energy contained in the layer from the previous timestep. Using these two energy terms and the depth of the respective layer, one can obtain the layer temperature through this equation;
\begin{equation}
	T = E_{layer}/c_h*depth
	\label{eq:layertemp}
\end{equation}

In Eq. (\ref{eq:layertemp}) $c_h = 2.2*10^6 [Jm^{-3}K^{-1}]$ is the heat capacity of rock and $depth$ is the depth of the respective layer.   


\subsection{Water Balance}
The water balance is based on conservation of mass, and describes the flow of water into and out of a closed system. This system may for example be a catchment, a lake or a column of soil. Used in areas like agriculture, runoff assessment or pollution control, making a water balance is a neat way to keep track of where the water in your system has come from and where it is going.  
//
To quantitatively study the water balance it is necessary to distinguish the different contributing processes. In its simplest form, the water balance can be written as (from$ https://www.geo.fu-berlin.de/en/v/iwm-network/learning_content/environmental-background/basics_hydrogeography/water_balance/index.html)$;
\begin{equation}
	S = P - E - R - G 
	\label{eq:waterbalance}
\end{equation}

In Eq. \ref{eq:waterbalance} $P$ is precipitation $[$unit of height$]$, $E$ is evaporation $[$unit of height$]$, $R$ is runoff $[$unit of height$]$ out of the region and $G$ is the groundwater flow or subsurface runoff $[$unit of height$]$. If several point in a grid were to be evaluated the the fluxes $R$ and $G$ should include both incoming and outgoing components. In this model no $R_{in}$ or $G_{in}$ are taken into account for simplification.   

In this model the surface energy balance becomes important as the water balance is only calculated for $T_{surf}$ and $T_{ground}$ $>=0$. This means that once the water is frozen the water balance remains unchanged. Once water is unfrozen a so-called \textit{bucket-model} is applied, meaning that surface runoff $R$ in Eq. (\ref{eq:waterbalance}) is determined as
\begin{equation}
	R = max(0, P-E-G-B)
	\label{eq:runoff}
\end{equation}  
where $B$ is the bucket depth, simulating the total soil depth where water can be stored. It is evident from Eq. (\ref{eq:runoff}) that that surface runoff is highly dependent on the bucket depth, but also on the relative sizes of $P$, $E$ and $G$. In particular, one should see a increased runoff for consecutive days with heavy rainfall especially for shallow soil.  

\subsection{Metrics used to evaluated solutions}

The main metric used to evaluate the performance of the neural network compared to the analytic scheme is the Mean Squared Error (MSE). As the name suggests, this metric quantifies the mean of the squares of the error between the prediction $\hat{x}_i$ and the observed value $x_i$. Thus, 

\begin{equation*}
MSE = \frac{1}{n}\sum_{i=1}^n (x_i - \hat{x}_i)^2
\end{equation*}

where $n$ is the number of samples. MSE value of 0 would prediction of the observed value, thus the closer to zero the better prediction.  

\subsection{Area}
In this study forcing data from Finse is used in the bucket model. Located at 1222 meters above sea level, on the northwestern part of the Hardangervidda plateau in Norway, Finse has a rather oceanic climate with mild winters for its altitude and cool summers \cite{finse}. Winter temperatures in the range of -20\textdegree C and summer temperatures in the range of 20\textdegree C is not uncommon. Monthly average precipitation was around 80mm between March 2019 and March 2020, peaking in September and October. Finse is very exposed to winds and frequently experiences winds in the range of 15-25 m/s \cite{yr}. 

\textbf{Something of choice of soil depth}. 
Two experiments will be done with the bucket model, one with a fixed initial water level for each bucket depth and one with a initial water level equal to half the bucket depth for each bucket depth. For the fixed bucket depth 0.1m is chosen. Finse is well above the tree line, and with very sparse vegetation and significant areas of bare mountain this serves as a estimate of averaged initial water content.     

\section{Method}
\subsection{Implementation of Algorithm}
The code: Starts of with if statement to ensure no freezing in the system. Here saturation is defined as water level divided by the bucket depth. Evapotranspiration is calculated using the $Q\_eq$-script with temperature, absolute humidity, wind speed and saturation as input. Now the water balance is calculated with no-freezing conditions. Water level is adjusted to be rainfall - evapotranspiration - subsurface runoff added to the water level from the previous timestep. Then the surface runoff is defined as the excess water when subtracting the bucket depth from the water level. 


MAIN POINT: Describe how the loop works and about the other helping-scripts in use. 

\subsection{Forcing Data}

This simple \textit{bucket model} used in this project is dependent on forcing to function as intended. Windspeed, air temperature, rainfall, relative humidity, specific humidity, shortwave incoming radiation and longwave incoming radiation from 2nd of October 2014 to 16th of March 2019 is provided by the Applications of Research to Operations at Mesoscale (AROME) model. This convection-permitting model is a high resolution model operated by MetCoOp, an collaborative effort between the Swedish Meteorological and Hydrological Institute and the Norwegian Meteorological Institute \cite{muller}. 


\section{Results}
Explain the weather situation/data over the two years. Especially precipitation (with or without freezing.)

Show in Figure (\ref{fig:forcing}), the forcing data used in the model includes a clear annual cycle in temperature. Temperatures ranges from around -25\textdegree C in winter to around 18\textdegree C in summer. The precipitation data in grey are daily values for every 3-hours. The AROME model is known (SOURCE) to overestimate precipitation in mountain regions and in general to overestimate large precipitation events, but even taken this into account the gray line values are extremely high for this area. Therefore, running a moving average for every day results in the black line, showing the average daily precipitation values with maxima around 90 mm/day. These values appear to be correct for the area in question.   

\begin{figure}[h]
	\centering 
	\includegraphics[width=0.5\textwidth]{figures/forcing_finse}
	\caption{Temperature (red) and precipitation(grey) data from forcing file. Daily mean values (black) printed for readability.}
	\label{fig:forcing}
\end{figure}

The precipitation output from the bucket model results in Figure(\ref{fig:precip}). Now the precipitation flattens once the ground temperature drops below zero. The step-like feature in the second winter arises because the precipitation value is kept at the last recorded value with temperature above zero degrees.

\begin{figure}[h]
	\centering 
	\includegraphics[width=0.5\textwidth]{figures/precip}
	\caption{Surface temperature (red) and precipitation(black) from the bucket model.}
	\label{fig:precip}
\end{figure}

Once we have established that the model is not allowing freezing, we look at how the soil deals with precipitation events. First, the bucket model is set with a constant initial water level of 0.1 meters. Figure(\ref{fig:bucket_fixed}) shows how the water level is rising after each precipitation event, but also how it drops if the precipitation ends. Now the flat part of the curves have two physical interpretations. Firstly, no precipitation occurs in these time slots as indicated by the grey line in the figure. Secondly,the bucket may have become full and is unable to store more water. Already in the first zero-precipitation window the shallowest bucket(0.2 meters)became full. The 0.4 meters deep bucket was close to full, but managed some more centimetres before getting filled in the first summer.
One interesting feature is that both the 0.8 meters and 1.0 meters buckets makes it though the entire summer without reaching their limits. \textbf{Some source on if this is usual or not?}. The 0.6 meter bucket reaches saturation sometime towards the end of the summer. 

\begin{figure}[h]
	\centering 
	\includegraphics[width=0.5\textwidth]{figures/bucket_fixed}
	\caption{Time evolution of water level in soil dependent on the bucket depth with an fixed initial water level of 0.1 meters. Gray lines is precipitation for reference.}
	\label{fig:bucket_fixed}
\end{figure}

\section{Discussion}
The fact that the 0.6 meter bucket in  Figure(\ref{fig:bucket_fixed}) almost made it through the entire summer without getting saturated may indicate that there are some other important processes for removal of water at Finse in action.  
\section{Future Work}
 
\twocolumn
[
\begin{@twocolumnfalse}


\medskip

\begin{thebibliography}{9}

\bibitem{muller}
\textit{AROME-MetCoOp: A Nordic Convective-Scale Operational
Weather Prediction Model}\\
MÜller et al. 2017\\
URL: \url{https://doi.org/10.1175/WAF-D-16-0099.1}

\bibitem{finse}
Webpage of Finse Alpine Research Ceenter\\
URL: \url{https://www.finse.uio.no/about/location/}

\bibitem{yr}
URL: \url{https://www.yr.no/nb/historikk/graf/1-111123/Norge/Vestland/Ulvik/Finse}


\end{thebibliography} 


\end{@twocolumnfalse}
\
]

\end{document}